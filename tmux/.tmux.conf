# ===== Vim 风格按键绑定 =====

# 设置前缀键为 Ctrl-a（可选，默认是 Ctrl-b）
# set -g prefix C-a
# unbind C-b
# bind C-a send-prefix

# 开启 vi 模式
setw -g mode-keys vi

# 使用 hjkl 在 pane 之间切换
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# 使用 Ctrl+hjkl 无需前缀键直接切换 pane
bind -n C-h select-pane -L
bind -n C-j select-pane -D
bind -n C-k select-pane -U
bind -n C-l select-pane -R

# 使用 Alt+hjkl 无需前缀键切换 pane（macOS 友好）
bind -n M-h select-pane -L
bind -n M-j select-pane -D
bind -n M-k select-pane -U
bind -n M-l select-pane -R

# 使用 HJKL 调整 pane 大小
bind -r H resize-pane -L 5
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5

# 使用 | 和 - 分割窗口（更直观）
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"

# 使用 vim 风格的复制模式
bind -T copy-mode-vi v send -X begin-selection
bind -T copy-mode-vi y send -X copy-selection-and-cancel
bind -T copy-mode-vi Escape send -X cancel

# 快速切换窗口
bind -n M-1 select-window -t 1
bind -n M-2 select-window -t 2
bind -n M-3 select-window -t 3
bind -n M-4 select-window -t 4
bind -n M-5 select-window -t 5

# 使用 n/p 或 C-n/C-p 切换窗口
bind -n M-n next-window
bind -n M-p previous-window

# ===== 预设布局 =====

# 快速创建双分割面板 (prefix + D)
bind D split-window -h -c "#{pane_current_path}" \; select-pane -L

# 创建开发布局: 左侧编辑器 + 右侧终端 (prefix + E)
bind E split-window -h -p 35 -c "#{pane_current_path}" \; select-pane -L

# ===== 其他实用配置 =====

# 窗口编号从 1 开始
set -g base-index 1
setw -g pane-base-index 1

# 重新加载配置
bind r source-file ~/.tmux.conf \; display "配置已重新加载!"

# 启用鼠标支持
set -g mouse on

# 减少 escape 延迟（对 vim 用户很重要）
set -sg escape-time 0

# 增加历史记录
set -g history-limit 10000

# 256 色支持
set -g default-terminal "tmux-256color"
set -ga terminal-overrides ",xterm-256color:Tc"

# ===== Catppuccin 主题 =====

# 设置风格为 Mocha
set -g @catppuccin_flavor "mocha"

# 窗口样式
set -g @catppuccin_window_status_style "rounded"

# 状态栏配置
set -g status-right-length 100
set -g status-left-length 100
set -g status-left ""
set -g status-right "#{E:@catppuccin_status_application}"
set -ag status-right "#{E:@catppuccin_status_session}"

# ===== TPM 插件管理器 =====

# 插件列表
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'catppuccin/tmux#v2.1.3'

# 初始化 TPM（保持在配置文件最后）
run '~/.tmux/plugins/tpm/tpm'
